
# Bitrix IBlock Manager and News List

## Описание проекта

Этот проект предназначен для управления инфоблоками и получения списка новостей через API 1С-Битрикс. В проекте реализованы два класса:

- **IblockCreator** — для создания и удаления инфоблоков с их полным сбросом.
- **NewsList** — для получения списка новостей из инфоблока в формате JSON с поддержкой кэширования, пагинации и лимитов.

### Основные возможности:

1. **IblockCreator**:
   - Создание инфоблоков по переданным именам.
   - Удаление всех инфоблоков с возможностью сброса автоинкремента (счётчиков ID).
   - Проверка и создание типа инфоблока, если он отсутствует.

2. **NewsList**:
   - Получение списка новостей за определённый период с поддержкой фильтрации, пагинации и кэширования.
   - Форматирование новостей в JSON-ответ с полями `id`, `url`, `image`, `name`, `sectionName`, `date`, `author`, `tags`.

## Структура проекта

```
/project_root/
|-- /src/
|   |-- IblockCreator.php         # Класс для создания и удаления инфоблоков
|   |-- NewsList.php              # Класс для получения новостей из инфоблоков
|-- /bitrix/php_interface/init.php  # Подключение классов и логики в систему
|-- README.md                     # Документация проекта
```

## Установка

### 1. Копирование файлов

Скопируйте файлы проекта в директорию вашего проекта Bitrix. Обычно файлы классов размещаются в директории `/bitrix/php_interface/include/`.

### 2. Подключение классов в `init.php`

Чтобы классы автоматически подключались в вашем проекте, необходимо подключить их в файле `/bitrix/php_interface/init.php`. Добавьте следующий код:

```php
use Bitrix\Main\Loader;

Loader::includeModule('iblock');

require_once($_SERVER['DOCUMENT_ROOT'] . "/bitrix/php_interface/include/IblockCreator.php");
require_once($_SERVER['DOCUMENT_ROOT'] . "/bitrix/php_interface/include/NewsList.php");
```

### 3. Использование IblockCreator

Для создания инфоблоков используйте следующий код:

```php
$iblockCreator = new IblockCreator('content'); // Укажите тип инфоблока
$iblockCreator->setIblockNames(12);            // Задайте количество инфоблоков
$iblockCreator->createIblocks();               // Создание инфоблоков
```

Для удаления инфоблоков и сброса счётчиков ID:

```php
$iblockCreator->fullDeleteIblocks();
```

### 4. Использование NewsList

Для получения списка новостей с кэшированием и пагинацией используйте следующий код:

```php
$newsList = new NewsList(10, 1); // Лимит выборки - 10 новостей, страница - 1
echo $newsList->toJson();        // Получение новостей в формате JSON
```

## Деинсталляция

1. Откройте файл `/bitrix/php_interface/init.php` и удалите строки, связанные с подключением классов `IblockCreator` и `NewsList`.
2. Удалите файлы классов из директории `/bitrix/php_interface/include/`.
3. При необходимости, удалите инфоблоки через административную панель или используя метод `$iblockCreator->fullDeleteIblocks()`.

## Автор

Разработано для использования с 1С-Битрикс. Автор: [Ваше Имя]
